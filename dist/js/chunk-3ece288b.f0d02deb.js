(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ece288b"],{"0668":function(e,t,r){"use strict";r("3cba")},"14ca":function(e,t,r){"use strict";r("9799")},"3cba":function(e,t,r){},"498a":function(e,t,r){"use strict";var a=r("23e7"),n=r("58a8").trim,s=r("c8d2");a({target:"String",proto:!0,forced:s("trim")},{trim:function(){return n(this)}})},9799:function(e,t,r){},ad68:function(e,t,r){"use strict";r.r(t);var a=r("7a23"),n={class:"container py-5"},s=Object(a["h"])("hr",null,null,-1);function c(e,t,r,c,i,u){var o=Object(a["A"])("spinner"),l=Object(a["A"])("restaurant-detail"),b=Object(a["A"])("restaurant-comments"),d=Object(a["A"])("create-comment");return Object(a["t"])(),Object(a["e"])("div",n,[i.isLoading?(Object(a["t"])(),Object(a["e"])(o,{key:0})):(Object(a["t"])(),Object(a["e"])(a["a"],{key:1},[Object(a["h"])(l,{"initial-restaurant":i.restaurant},null,8,["initial-restaurant"]),s,Object(a["h"])(b,{"restaurant-comments":i.restaurantComments,onDeleteComment:u.deleteComment},null,8,["restaurant-comments","onDeleteComment"]),Object(a["h"])(d,{"restaurant-id":i.restaurant.id,onAddComment:u.addComment},null,8,["restaurant-id","onAddComment"])],64))])}var i=r("1da1"),u=r("5530"),o=(r("96cf"),r("b0c0"),r("a4d3"),r("e01a"),r("4de4"),r("5502")),l=Object(a["N"])("data-v-74ecdf30");Object(a["w"])("data-v-74ecdf30");var b={class:"row"},d={class:"col-md-12 mb-3"},m={class:"badge badge-secondary mt-1 mb-3"},p={class:"col-md-8 col-lg-6 col-xl-4 mb-3"},O={class:"col-lg-6"},j={class:"contact-info-wrap"},h={class:"list-unstyled"},f=Object(a["h"])("strong",null,"Opening Hour:",-1),v=Object(a["h"])("strong",null,"Tel:",-1),g=Object(a["h"])("strong",null,"Address:",-1),k=Object(a["g"])("Dashboard");Object(a["u"])();var x=l((function(e,t,r,n,s,c){var i=Object(a["A"])("router-link");return Object(a["t"])(),Object(a["e"])("div",b,[Object(a["h"])("div",d,[Object(a["h"])("h1",null,Object(a["D"])(s.restaurant.name),1),Object(a["h"])("p",m,Object(a["D"])(s.restaurant.categoryName),1)]),Object(a["h"])("div",p,[Object(a["h"])("img",{class:"img-responsive center-block",src:e.$filter.emptyImageFilter(s.restaurant.image)},null,8,["src"])]),Object(a["h"])("div",O,[Object(a["h"])("div",j,[Object(a["h"])("ul",h,[Object(a["h"])("li",null,[f,Object(a["g"])(" "+Object(a["D"])(s.restaurant.openingHours),1)]),Object(a["h"])("li",null,[v,Object(a["g"])(" "+Object(a["D"])(s.restaurant.tel),1)]),Object(a["h"])("li",null,[g,Object(a["g"])(" "+Object(a["D"])(s.restaurant.address),1)])])]),Object(a["h"])("p",null,Object(a["D"])(s.restaurant.description),1),Object(a["h"])(i,{class:"btn btn-red btn-border me-2",to:{name:"restaurant-dashboard",params:{id:s.restaurant.id}}},{default:l((function(){return[k]})),_:1},8,["to"]),s.restaurant.isFavorited?(Object(a["t"])(),Object(a["e"])("button",{key:0,type:"button",class:"btn btn-danger btn-border me-2",onClick:t[1]||(t[1]=Object(a["M"])((function(e){return c.removeFavorite(s.restaurant.id)}),["prevent","stop"]))}," Remove from Fav ")):(Object(a["t"])(),Object(a["e"])("button",{key:1,type:"button",class:"btn btn-red btn-border me-2",onClick:t[2]||(t[2]=Object(a["M"])((function(e){return c.addFavorite(s.restaurant.id)}),["prevent","stop"]))}," Add to Fav ")),s.restaurant.isLiked?(Object(a["t"])(),Object(a["e"])("button",{key:2,type:"button",class:"btn btn-danger like me-2",onClick:t[3]||(t[3]=Object(a["M"])((function(e){return c.unlike(s.restaurant.id)}),["prevent","stop"]))}," Unlike ")):(Object(a["t"])(),Object(a["e"])("button",{key:3,type:"button",class:"btn btn-red like me-2",onClick:t[4]||(t[4]=Object(a["M"])((function(e){return c.like(s.restaurant.id)}),["prevent","stop"]))}," Like "))])])})),w=r("c4c3"),y=r("2fa3"),C={props:{initialRestaurant:{type:Object,required:!0}},data:function(){return{restaurant:this.initialRestaurant}},watch:{initialRestaurant:function(e){this.restaurant=Object(u["a"])(Object(u["a"])({},this.restaurant),e)}},methods:{addFavorite:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,w["a"].addFavorite({restaurantId:e});case 3:if(a=r.sent,n=a.data,"success"===n.status){r.next=7;break}throw new Error(n.message);case 7:t.restaurant=Object(u["a"])(Object(u["a"])({},t.restaurant),{},{isFavorited:!0}),r.next=14;break;case 10:r.prev=10,r.t0=r["catch"](0),console.log(r.t0),y["b"].fire({icon:"error",title:"Unable to add the restaurant to your favorite list, please try again later."});case 14:case"end":return r.stop()}}),r,null,[[0,10]])})))()},removeFavorite:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,w["a"].removeFavorite({restaurantId:e});case 3:if(a=r.sent,n=a.data,"success"===n.status){r.next=7;break}throw new Error(n.message);case 7:t.restaurant=Object(u["a"])(Object(u["a"])({},t.restaurant),{},{isFavorited:!1}),r.next=13;break;case 10:r.prev=10,r.t0=r["catch"](0),y["b"].fire({icon:"error",title:"Unable to remove the restaurant from your favorite list, please try again later."});case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()},like:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,w["a"].like({restaurantId:e});case 3:if(a=r.sent,n=a.data,"success"===n.status){r.next=7;break}throw new Error(n.message);case 7:t.restaurant=Object(u["a"])(Object(u["a"])({},t.restaurant),{},{isLiked:!0}),r.next=13;break;case 10:r.prev=10,r.t0=r["catch"](0),y["b"].fire({icon:"error",title:"Unable to like the restaurant, please try again later."});case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()},unlike:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,w["a"].unlike({restaurantId:e});case 3:if(a=r.sent,n=a.data,"success"===n.status){r.next=7;break}throw new Error(n.message);case 7:t.restaurant=Object(u["a"])(Object(u["a"])({},t.restaurant),{},{isLiked:!1}),r.next=13;break;case 10:r.prev=10,r.t0=r["catch"](0),y["b"].fire({icon:"error",title:"Unable to unlike the restaurant, please try again later."});case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()}}};r("14ca");C.render=x,C.__scopeId="data-v-74ecdf30";var R=C,I=Object(a["N"])("data-v-1cded4b0");Object(a["w"])("data-v-1cded4b0");var U=Object(a["h"])("h2",{class:"my-4"}," All comments： ",-1),_={class:"people-comment-wrapper"},A={class:"people-avatar pt-1"},F={class:"people-comment"},D={class:"people-comment-container"},L={class:"people-name"},E={class:"people-saying"},N=Object(a["h"])("i",{class:"fas fa-trash-alt"},null,-1),$={class:"date-wrapper"},M={class:"days-comment"},P=Object(a["h"])("hr",null,null,-1);Object(a["u"])();var S=I((function(e,t,r,n,s,c){var i=Object(a["A"])("router-link");return Object(a["t"])(),Object(a["e"])("div",null,[U,Object(a["h"])("div",null,[Object(a["h"])(a["b"],{"enter-active-class":"animate__animated animate__bounceInUp","leave-active-class":"animate__animated animate__fadeOut"},{default:I((function(){return[(Object(a["t"])(!0),Object(a["e"])(a["a"],null,Object(a["z"])(r.restaurantComments,(function(t){return Object(a["t"])(),Object(a["e"])("div",{key:t.id},[Object(a["h"])("div",_,[Object(a["h"])("div",A,[Object(a["h"])("img",{src:e.$filter.emptyImageFilter(t.User.image),alt:""},null,8,["src"])]),Object(a["h"])("div",F,[Object(a["h"])("div",D,[Object(a["h"])("div",L,[Object(a["h"])(i,{to:{name:"user-profile",params:{id:t.User.id}}},{default:I((function(){return[Object(a["g"])(Object(a["D"])(t.User.name),1)]})),_:2},1032,["to"])]),Object(a["h"])("div",E,Object(a["D"])(t.text),1),e.currentUser.isAdmin?(Object(a["t"])(),Object(a["e"])("span",{key:0,class:"delete-btn",onClick:Object(a["M"])((function(e){return c.deleteComment(t.id)}),["prevent","stop"])},[N],8,["onClick"])):Object(a["f"])("",!0)])])]),Object(a["h"])("div",$,[Object(a["h"])("div",M,"- "+Object(a["D"])(e.$filter.fromNow(t.createdAt)),1)])])})),128))]})),_:1}),P])])})),q={create:function(e){var t=e.text,r=e.restaurantId;return y["c"].post("/comments",{text:t,restaurantId:r})},delete:function(e){var t=e.commentId;return y["c"].delete("/comments/".concat(t))}},H={props:{restaurantComments:{type:Array,required:!0}},computed:Object(u["a"])({},Object(o["b"])(["currentUser"])),emits:["delete-comment"],methods:{deleteComment:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(y["a"])();case 3:if(a=r.sent,!a.isConfirmed){r.next=14;break}return r.next=7,q.delete({commentId:e});case 7:if(n=r.sent,s=n.data,"success"===s.status){r.next=13;break}if("error"!==s.status){r.next=12;break}return r.abrupt("return",y["b"].fire({icon:"error",title:s.message}));case 12:throw new Error(s.message);case 13:t.$emit("delete-comment",e);case 14:return r.abrupt("return",null);case 17:return r.prev=17,r.t0=r["catch"](0),console.log(r.t0),r.abrupt("return",y["b"].fire({icon:"error",title:"Unable to delete the comment, please try again later."}));case 21:case"end":return r.stop()}}),r,null,[[0,17]])})))()}}};r("dbe7");H.render=S,H.__scopeId="data-v-1cded4b0";var V=H,z=Object(a["N"])("data-v-38409469");Object(a["w"])("data-v-38409469");var J={class:"form-group mb-4"},B=Object(a["h"])("label",{class:"mb-2 form-label",for:"text"},"Leave your comment：(must be greater than 50 and less than 200 characters)",-1),T={class:"d-flex align-items-center justify-content-between"};Object(a["u"])();var Y=z((function(e,t,r,n,s,c){var i=Object(a["A"])("vee-field"),u=Object(a["A"])("ErrorMessage"),o=Object(a["A"])("vee-form");return Object(a["t"])(),Object(a["e"])(o,{"validation-schema":s.schema,onSubmit:c.submitComment},{default:z((function(){return[Object(a["h"])("div",J,[B,Object(a["h"])(i,{as:"textarea",modelValue:s.text,"onUpdate:modelValue":t[1]||(t[1]=function(e){return s.text=e}),class:"form-control",rows:"3",name:"text"},null,8,["modelValue"]),Object(a["h"])(u,{class:"text-red",name:"text"})]),Object(a["h"])("div",T,[Object(a["h"])("button",{type:"button",class:"btn btn-link",onClick:t[2]||(t[2]=function(t){return e.$router.back()})},"Back"),Object(a["h"])("button",{type:"submit",class:"btn btn-red mr-0",disabled:s.isProcessing}," Submit ",8,["disabled"])])]})),_:1},8,["validation-schema","onSubmit"])})),G=(r("a9e3"),r("498a"),{name:"CreateComment",props:{restaurantId:{type:Number,required:!0}},data:function(){return{text:"",isProcessing:!1,schema:{text:"required|min:50|max:200"}}},methods:{submitComment:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!(!e.text.trim()||e.text.trim().length<50||e.text.trim().length>200)){t.next=3;break}return t.abrupt("return",y["b"].fire({icon:"warning",title:"Your comment does not meet the required length."}));case 3:return e.isProcessing=!0,t.next=6,q.create({text:e.text,restaurantId:e.restaurantId});case 6:if(r=t.sent,a=r.data,"success"===a.status){t.next=13;break}if(e.isProcessing=!1,"error"!==a.status){t.next=12;break}return t.abrupt("return",y["b"].fire({icon:"error",title:a.message}));case 12:throw new Error(a.message);case 13:return e.$emit("add-comment",{commentId:a.comment.id,restaurantId:e.restaurantId,text:e.text}),e.text="",e.isProcessing=!1,t.abrupt("return",null);case 19:return t.prev=19,t.t0=t["catch"](0),e.isProcessing=!1,console.log(t.t0),t.abrupt("return",y["b"].fire({icon:"error",title:"Unable to post a comment, please try again later."}));case 24:case"end":return t.stop()}}),t,null,[[0,19]])})))()}}});r("0668");G.render=Y,G.__scopeId="data-v-38409469";var K=G,Q=r("2375"),W={name:"restaurant",data:function(){return{restaurant:{id:-1,name:"",categoryName:"",image:"",openingHours:"",tel:"",address:"",description:"",isFavorited:!1,isLiked:!1},restaurantComments:[],isLoading:!0}},computed:Object(u["a"])({},Object(o["b"])(["currentUser"])),components:{RestaurantDetail:R,RestaurantComments:V,CreateComment:K,Spinner:Q["a"]},methods:{fetchRestaurant:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,s,c,i,u,o,l,b,d,m,p;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isLoading=!0,r.next=4,w["a"].getRestaurant({restaurantId:e});case 4:if(a=r.sent,n=a.data,"success"===n.status){r.next=10;break}if("error"!==n.status){r.next=9;break}return r.abrupt("return",y["b"].fire({icon:"error",title:n.message}));case 9:throw new Error(n.message);case 10:return s=n.restaurant,c=n.isFavorited,i=n.isLiked,u=s.id,o=s.name,l=s.Category,b=s.image,d=s.tel,m=s.address,p=s.description,t.restaurant={id:u,name:o,categoryName:l?l.name:"uncategorized",image:b,openingHours:s.opening_hours,tel:d,address:m,description:p,isFavorited:c,isLiked:i},t.restaurantComments=s.Comments,t.isLoading=!1,r.abrupt("return",null);case 18:return r.prev=18,r.t0=r["catch"](0),t.isLoading=!1,console.log(r.t0),r.abrupt("return",y["b"].fire({icon:"error",title:"Sorry, we can not get restaurant data rignt now, please try again later."}));case 23:case"end":return r.stop()}}),r,null,[[0,18]])})))()},deleteComment:function(e){this.restaurantComments=this.restaurantComments.filter((function(t){return t.id!==e}))},addComment:function(e){var t=e.commentId,r=e.restaurantId,a=e.text;this.restaurantComments.push({id:t,RestaurantId:r,User:{id:this.currentUser.id,name:this.currentUser.name,image:this.currentUser.image},text:a,createdAt:new Date})}},created:function(){var e=this.$route.params.id;this.fetchRestaurant(e)},beforeRouteUpdate:function(e,t,r){var a=e.params.id;this.fetchRestaurant(a),r()}};W.render=c;t["default"]=W},c645:function(e,t,r){},c8d2:function(e,t,r){var a=r("d039"),n=r("5899"),s="​᠎";e.exports=function(e){return a((function(){return!!n[e]()||s[e]()!=s||n[e].name!==e}))}},dbe7:function(e,t,r){"use strict";r("c645")}}]);
//# sourceMappingURL=chunk-3ece288b.f0d02deb.js.map
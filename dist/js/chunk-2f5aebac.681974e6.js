(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f5aebac"],{"34a7":function(e,t,r){},"498a":function(e,t,r){"use strict";var a=r("23e7"),n=r("58a8").trim,s=r("c8d2");a({target:"String",proto:!0,forced:s("trim")},{trim:function(){return n(this)}})},"5f30":function(e,t,r){"use strict";r("da55")},"949d":function(e,t,r){"use strict";r("b710")},ad68:function(e,t,r){"use strict";r.r(t);var a=r("7a23"),n={class:"container py-5"},s=Object(a["g"])("hr",null,null,-1);function c(e,t,r,c,i,o){var u=Object(a["w"])("spinner"),b=Object(a["w"])("restaurant-detail"),l=Object(a["w"])("restaurant-comments"),d=Object(a["w"])("create-comment");return Object(a["p"])(),Object(a["d"])("div",n,[i.isLoading?(Object(a["p"])(),Object(a["d"])(u,{key:0})):(Object(a["p"])(),Object(a["d"])(a["a"],{key:1},[Object(a["g"])(b,{"initial-restaurant":i.restaurant},null,8,["initial-restaurant"]),s,Object(a["g"])(l,{"restaurant-comments":i.restaurantComments,onDeleteComment:o.deleteComment},null,8,["restaurant-comments","onDeleteComment"]),Object(a["g"])(d,{"restaurant-id":i.restaurant.id,onAddComment:o.addComment},null,8,["restaurant-id","onAddComment"])],64))])}var i=r("1da1"),o=r("5530"),u=(r("96cf"),r("b0c0"),r("a4d3"),r("e01a"),r("4de4"),r("5502")),b=Object(a["H"])("data-v-66bc4a3f");Object(a["s"])("data-v-66bc4a3f");var l={class:"row"},d={class:"col-md-12 mb-3"},m={class:"badge badge-secondary mt-1 mb-3"},p={class:"col-md-8 col-lg-6 col-xl-4 mb-3"},g={class:"col-lg-6"},j={class:"contact-info-wrap"},O={class:"list-unstyled"},f=Object(a["g"])("strong",null,"Opening Hour:",-1),v=Object(a["g"])("strong",null,"Tel:",-1),h=Object(a["g"])("strong",null,"Address:",-1),k=Object(a["f"])("Dashboard");Object(a["q"])();var w=b((function(e,t,r,n,s,c){var i=Object(a["w"])("router-link");return Object(a["p"])(),Object(a["d"])("div",l,[Object(a["g"])("div",d,[Object(a["g"])("h1",null,Object(a["y"])(s.restaurant.name),1),Object(a["g"])("p",m,Object(a["y"])(s.restaurant.categoryName),1)]),Object(a["g"])("div",p,[Object(a["g"])("img",{class:"img-responsive center-block",src:e.$filter.emptyImageFilter(s.restaurant.image)},null,8,["src"])]),Object(a["g"])("div",g,[Object(a["g"])("div",j,[Object(a["g"])("ul",O,[Object(a["g"])("li",null,[f,Object(a["f"])(" "+Object(a["y"])(s.restaurant.openingHours),1)]),Object(a["g"])("li",null,[v,Object(a["f"])(" "+Object(a["y"])(s.restaurant.tel),1)]),Object(a["g"])("li",null,[h,Object(a["f"])(" "+Object(a["y"])(s.restaurant.address),1)])])]),Object(a["g"])("p",null,Object(a["y"])(s.restaurant.description),1),Object(a["g"])(i,{class:"btn btn-primary btn-border me-2",to:{name:"restaurant-dashboard",params:{id:s.restaurant.id}}},{default:b((function(){return[k]})),_:1},8,["to"]),s.restaurant.isFavorited?(Object(a["p"])(),Object(a["d"])("button",{key:0,type:"button",class:"btn btn-danger btn-border me-2",onClick:t[1]||(t[1]=Object(a["G"])((function(e){return c.removeFavorite(s.restaurant.id)}),["prevent","stop"]))}," Remove from Fav ")):(Object(a["p"])(),Object(a["d"])("button",{key:1,type:"button",class:"btn btn-primary btn-border me-2",onClick:t[2]||(t[2]=Object(a["G"])((function(e){return c.addFavorite(s.restaurant.id)}),["prevent","stop"]))}," Add to Fav ")),s.restaurant.isLiked?(Object(a["p"])(),Object(a["d"])("button",{key:2,type:"button",class:"btn btn-danger like me-2",onClick:t[3]||(t[3]=Object(a["G"])((function(e){return c.unlike(s.restaurant.id)}),["prevent","stop"]))}," Unlike ")):(Object(a["p"])(),Object(a["d"])("button",{key:3,type:"button",class:"btn btn-primary like me-2",onClick:t[4]||(t[4]=Object(a["G"])((function(e){return c.like(s.restaurant.id)}),["prevent","stop"]))}," Like "))])])})),y=r("c4c3"),x=r("2fa3"),C={props:{initialRestaurant:{type:Object,required:!0}},data:function(){return{restaurant:this.initialRestaurant}},watch:{initialRestaurant:function(e){this.restaurant=Object(o["a"])(Object(o["a"])({},this.restaurant),e)}},methods:{addFavorite:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,y["a"].addFavorite({restaurantId:e});case 3:if(a=r.sent,n=a.data,"success"===n.status){r.next=7;break}throw new Error(n.message);case 7:t.restaurant=Object(o["a"])(Object(o["a"])({},t.restaurant),{},{isFavorited:!0}),r.next=14;break;case 10:r.prev=10,r.t0=r["catch"](0),console.log(r.t0),x["b"].fire({icon:"error",title:"Unable to add the restaurant to your favorite list, please try again later."});case 14:case"end":return r.stop()}}),r,null,[[0,10]])})))()},removeFavorite:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,y["a"].removeFavorite({restaurantId:e});case 3:if(a=r.sent,n=a.data,"success"===n.status){r.next=7;break}throw new Error(n.message);case 7:t.restaurant=Object(o["a"])(Object(o["a"])({},t.restaurant),{},{isFavorited:!1}),r.next=13;break;case 10:r.prev=10,r.t0=r["catch"](0),x["b"].fire({icon:"error",title:"Unable to remove the restaurant from your favorite list, please try again later."});case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()},like:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,y["a"].like({restaurantId:e});case 3:if(a=r.sent,n=a.data,"success"===n.status){r.next=7;break}throw new Error(n.message);case 7:t.restaurant=Object(o["a"])(Object(o["a"])({},t.restaurant),{},{isLiked:!0}),r.next=13;break;case 10:r.prev=10,r.t0=r["catch"](0),x["b"].fire({icon:"error",title:"Unable to like the restaurant, please try again later."});case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()},unlike:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,y["a"].unlike({restaurantId:e});case 3:if(a=r.sent,n=a.data,"success"===n.status){r.next=7;break}throw new Error(n.message);case 7:t.restaurant=Object(o["a"])(Object(o["a"])({},t.restaurant),{},{isLiked:!1}),r.next=13;break;case 10:r.prev=10,r.t0=r["catch"](0),x["b"].fire({icon:"error",title:"Unable to unlike the restaurant, please try again later."});case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()}}};r("5f30");C.render=w,C.__scopeId="data-v-66bc4a3f";var R=C,I=Object(a["H"])("data-v-0bfc2bcc");Object(a["s"])("data-v-0bfc2bcc");var U=Object(a["g"])("h2",{class:"my-4"}," 所有評論： ",-1),F={class:"people-comment-wrapper"},L={class:"people-avatar pt-1"},_={class:"people-comment"},A={class:"people-comment-container"},q={class:"people-name"},E={class:"people-saying"},H=Object(a["g"])("i",{class:"fas fa-trash-alt"},null,-1),$={class:"date-wrapper"},G={class:"days-comment"},P=Object(a["g"])("hr",null,null,-1);Object(a["q"])();var D=I((function(e,t,r,n,s,c){var i=Object(a["w"])("router-link");return Object(a["p"])(),Object(a["d"])("div",null,[U,Object(a["g"])("div",null,[(Object(a["p"])(!0),Object(a["d"])(a["a"],null,Object(a["v"])(r.restaurantComments,(function(t){return Object(a["p"])(),Object(a["d"])("div",{key:t.id},[Object(a["g"])("div",F,[Object(a["g"])("div",L,[Object(a["g"])("img",{src:e.$filter.emptyImageFilter(t.User.image),alt:""},null,8,["src"])]),Object(a["g"])("div",_,[Object(a["g"])("div",A,[Object(a["g"])("div",q,[Object(a["g"])(i,{to:{name:"user-profile",params:{id:t.User.id}}},{default:I((function(){return[Object(a["f"])(Object(a["y"])(t.User.name),1)]})),_:2},1032,["to"])]),Object(a["g"])("div",E,Object(a["y"])(t.text),1),e.currentUser.isAdmin?(Object(a["p"])(),Object(a["d"])("span",{key:0,class:"delete-btn",onClick:Object(a["G"])((function(e){return c.deleteComment(t.id)}),["prevent","stop"])},[H],8,["onClick"])):Object(a["e"])("",!0)])])]),Object(a["g"])("div",$,[Object(a["g"])("div",G,"- "+Object(a["y"])(e.$filter.fromNow(t.createdAt)),1)])])})),128)),P])])})),N={create:function(e){var t=e.text,r=e.restaurantId;return x["c"].post("/comments",{text:t,restaurantId:r})},delete:function(e){var t=e.commentId;return x["c"].delete("/comments/".concat(t))}},S={props:{restaurantComments:{type:Array,required:!0}},computed:Object(o["a"])({},Object(u["b"])(["currentUser"])),emits:["delete-comment"],methods:{deleteComment:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(x["a"])();case 3:if(a=r.sent,!a.isConfirmed){r.next=14;break}return r.next=7,N.delete({commentId:e});case 7:if(n=r.sent,s=n.data,"success"===s.status){r.next=13;break}if("error"!==s.status){r.next=12;break}return r.abrupt("return",x["b"].fire({icon:"error",title:s.message}));case 12:throw new Error(s.message);case 13:t.$emit("delete-comment",e);case 14:return r.abrupt("return",null);case 17:return r.prev=17,r.t0=r["catch"](0),console.log(r.t0),r.abrupt("return",x["b"].fire({icon:"error",title:"Unable to delete the comment, please try again later."}));case 21:case"end":return r.stop()}}),r,null,[[0,17]])})))()}}};r("949d");S.render=D,S.__scopeId="data-v-0bfc2bcc";var B=S,J=Object(a["H"])("data-v-07210698");Object(a["s"])("data-v-07210698");var z={class:"form-group mb-4"},T=Object(a["g"])("label",{class:"mb-2 form-label",for:"text"},"Leave your comment：(must be greater than 50 and less than 200 characters)",-1),V={class:"d-flex align-items-center justify-content-between"};Object(a["q"])();var Y=J((function(e,t,r,n,s,c){return Object(a["p"])(),Object(a["d"])("form",{onSubmit:t[3]||(t[3]=Object(a["G"])((function(){return c.submitComment&&c.submitComment.apply(c,arguments)}),["prevent","stop"]))},[Object(a["g"])("div",z,[T,Object(a["F"])(Object(a["g"])("textarea",{"onUpdate:modelValue":t[1]||(t[1]=function(e){return s.text=e}),class:"form-control",rows:"3",name:"text"},null,512),[[a["B"],s.text]])]),Object(a["g"])("div",V,[Object(a["g"])("button",{type:"button",class:"btn btn-link",onClick:t[2]||(t[2]=function(t){return e.$router.back()})},"Back"),Object(a["g"])("button",{type:"submit",class:"btn btn-primary mr-0",disabled:s.isProcessing}," Submit ",8,["disabled"])])],32)})),K=(r("a9e3"),r("498a"),{name:"CreateComment",props:{restaurantId:{type:Number,required:!0}},data:function(){return{text:"",isProcessing:!1}},methods:{submitComment:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!(!e.text.trim()||e.text.trim().length<50||e.text.trim().length>200)){t.next=3;break}return t.abrupt("return",x["b"].fire({icon:"warning",title:"Your comment does not meet the required length."}));case 3:return e.isProcessing=!0,t.next=6,N.create({text:e.text,restaurantId:e.restaurantId});case 6:if(r=t.sent,a=r.data,"success"===a.status){t.next=13;break}if(e.isProcessing=!1,"error"!==a.status){t.next=12;break}return t.abrupt("return",x["b"].fire({icon:"error",title:a.message}));case 12:throw new Error(a.message);case 13:return e.$emit("add-comment",{commentId:a.comment.id,restaurantId:e.restaurantId,text:e.text}),e.text="",e.isProcessing=!1,t.abrupt("return",null);case 19:return t.prev=19,t.t0=t["catch"](0),e.isProcessing=!1,console.log(t.t0),t.abrupt("return",x["b"].fire({icon:"error",title:"Unable to post a comment, please try again later."}));case 24:case"end":return t.stop()}}),t,null,[[0,19]])})))()}}});r("ec30");K.render=Y,K.__scopeId="data-v-07210698";var M=K,Q=r("2375"),W={name:"restaurant",data:function(){return{restaurant:{id:-1,name:"",categoryName:"",image:"",openingHours:"",tel:"",address:"",description:"",isFavorited:!1,isLiked:!1},restaurantComments:[],isLoading:!0}},computed:Object(o["a"])({},Object(u["b"])(["currentUser"])),components:{RestaurantDetail:R,RestaurantComments:B,CreateComment:M,Spinner:Q["a"]},methods:{fetchRestaurant:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,s,c,i,o,u,b,l,d,m,p;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isLoading=!0,r.next=4,y["a"].getRestaurant({restaurantId:e});case 4:if(a=r.sent,n=a.data,"success"===n.status){r.next=10;break}if("error"!==n.status){r.next=9;break}return r.abrupt("return",x["b"].fire({icon:"error",title:n.message}));case 9:throw new Error(n.message);case 10:return s=n.restaurant,c=n.isFavorited,i=n.isLiked,o=s.id,u=s.name,b=s.Category,l=s.image,d=s.tel,m=s.address,p=s.description,t.restaurant={id:o,name:u,categoryName:b?b.name:"uncategorized",image:l,openingHours:s.opening_hours,tel:d,address:m,description:p,isFavorited:c,isLiked:i},t.restaurantComments=s.Comments,t.isLoading=!1,r.abrupt("return",null);case 18:return r.prev=18,r.t0=r["catch"](0),t.isLoading=!1,console.log(r.t0),r.abrupt("return",x["b"].fire({icon:"error",title:"Sorry, we can not get restaurant data rignt now, please try again later."}));case 23:case"end":return r.stop()}}),r,null,[[0,18]])})))()},deleteComment:function(e){this.restaurantComments=this.restaurantComments.filter((function(t){return t.id!==e}))},addComment:function(e){var t=e.commentId,r=e.restaurantId,a=e.text;this.restaurantComments.push({id:t,RestaurantId:r,User:{id:this.currentUser.id,name:this.currentUser.name,image:this.currentUser.image},text:a,createdAt:new Date})}},created:function(){var e=this.$route.params.id;this.fetchRestaurant(e)},beforeRouteUpdate:function(e,t,r){var a=e.params.id;this.fetchRestaurant(a),r()}};W.render=c;t["default"]=W},b710:function(e,t,r){},c8d2:function(e,t,r){var a=r("d039"),n=r("5899"),s="​᠎";e.exports=function(e){return a((function(){return!!n[e]()||s[e]()!=s||n[e].name!==e}))}},da55:function(e,t,r){},ec30:function(e,t,r){"use strict";r("34a7")}}]);
//# sourceMappingURL=chunk-2f5aebac.681974e6.js.map